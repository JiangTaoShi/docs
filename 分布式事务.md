1.有没有使用微服务？、数据一致性如何保证？

```
微服务架构有哪些优势？
1.独立开发 – 所有微服务都可以根据各自的功能轻松开发
2.独立部署 – 基于其服务，可以在任何应用程序中单独部署它们
3.故障隔离 – 即使应用程序的一项服务不起作用，系统仍可继续运行
4.混合技术堆栈 – 可以使用不同的语言和技术来构建同一应用程序的不同服务
5.粒度缩放 – 单个组件可根据需要进行缩放，无需将所有组件缩放在一起
微服务的特点
1.解耦 – 系统内的服务很大程度上是分离的。因此，整个应用程序可以轻松构建，更改和扩展
2.组件化 – 微服务被视为可以轻松更换和升级的独立组件
3.业务能力 – 微服务非常简单，专注于单一功能
4.自治 – 开发人员和团队可以彼此独立工作，从而提高速度
5.持续交付 – 通过软件创建，测试和批准的系统自动化，允许频繁发布软件
6.责任 – 微服务不关注应用程序作为项目。相反，他们将应用程序视为他们负责的产品
7.分散治理 – 重点是使用正确的工具来做正确的工作。这意味着没有标准化模式或任何技术模式。开发人员可以自由选择最有用的工具来解决他们的问题
8.敏捷 – 微服务支持敏捷开发。任何新功能都可以快速开发并再次丢弃
```

```
微服务架构模式有许多非常好的地方。
第一，它解决了复杂问题。它把可能会变得庞大的单体应用程序分解成一套服务。
第二，这种架构使得每个服务都可以由一个团队独立专注开发。开发者可以自由选择任何符合服务 API 契约的技术。
第三，微服务架构模式可以实现每一个微服务独立部署。

微服务的缺点
微服务另一个主要的缺点是由于微服务是一个分布式系统，其使得整体变得复杂。
开发者需要选择和实现基于消息或者 RPC 的进程间通信机制。
此外，由于目标请求可能很慢或者不可用，他们必须要编写代码来处理局部故障。
虽然这些都不是很复杂、高深，但模块间通过语言级方法/过程调用相互调用，这比单体应用要复杂得多。
追溯问题也不好
```

 一致性

```go
Saga:
集中式协调器负责服务调用以及事务协调
ACID(刚性事务)
原子性
一致性
隔离性
持久化
BASE(柔性事务)

CAP原理
一致性(Consistency)
可用性(Availability)
分区容忍性(Partition tolerance)
P + C: 具备强一致性，典型模式是二阶段提交（2PC）
P + A: 具备最终一致性，典型模式是Saga/柔性事务
BASE定理
基本可用（Basically Available）
软状态（Soft state）
最织一致（Eventually consistent）

在微服务架构中， 有一个database per service的模式， 这个模式就是每一个服务一个数据库。 这样可以保证微服务独立开发，独立演进，独立部署， 独立团队。
由于一个应用是由一组相互协作的微服务所组成，在分布式环境下由于各个服务访问的数据是相互分离的， 服务之间不能靠数据库来保证事务一致性。 这就需要在应用层面提供一个协调机制，来保证一组事务执行要么成功，要么失败。
由于隔离性互斥的要求，在事务执行过程中，所有的资源都是被锁定的，这种情况只适合执行时间确定的短事务。 但是为了保证分布式事务的一致性，大都是采用串行化的隔离级别来保证事务一致性，这样会降低系统的吞吐。
但因为2PC的协议成本比较高，又有全局锁的问题，性能会比较差。 现在大家基本上不会采用这种强一致解决方案。

在分布式系统中由于网络请求可能的延时，在Caitie的论文中对被Saga调用的服务提出两点要求，我们需要Saga调用的服务支持幂等。 在服务请求的过程中，可能会出现超时重试的情况，我们需要通过幂等来避免多次请求所带来的问题。

```

